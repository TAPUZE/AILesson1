<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>שיעור 1: ניהול פגישות יעיל בעזרת AI (עם מבואות הדרכה)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Assistant', sans-serif;
            scroll-behavior: smooth;
        }
        .lesson-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding-top: 7rem; 
            padding-bottom: 5rem;
            border-bottom: 1px solid #e2e8f0;
        }
        .intro-paragraph {
            font-size: 1.125rem; /* text-lg */
            color: #334155; /* slate-700 */
            background-color: #f1f5f9; /* slate-100 */
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            border-right: 4px solid #3b82f6; /* blue-500 */
        }
        .example-output-box {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            padding-top: 2rem; 
            direction: ltr;
            text-align: right;
            white-space: pre-wrap;
            font-family: monospace;
            color: #1e293b;
            position: relative;
            margin-top: 1rem;
            min-height: 100px; 
        }
        .example-output-box::before {
            content: 'פלט לדוגמה (מבוסס על יום הגיבוש)';
            position: absolute;
            top: -12px;
            right: 20px;
            background-color: inherit; 
            padding: 0 8px;
            font-family: 'Assistant', sans-serif;
            font-size: 0.875rem;
            color: #475569;
            font-weight: 600;
        }
         .gemini-output-box { 
            background-color: #e0f2fe; 
            border: 1px solid #7dd3fc; 
            border-radius: 0.75rem;
            padding: 1.5rem;
            padding-top: 2rem; 
            direction: rtl; 
            text-align: right;
            font-family: 'Assistant', sans-serif; 
            color: #0c4a6e; 
            position: relative;
            margin-top: 1rem;
            min-height: 80px; 
        }
        .gemini-output-box::before {
            content: '✨ הצעה מ-Gemini עבור הפרויקט שלך';
            position: absolute;
            top: -12px;
            right: 20px;
            background-color: inherit; 
            padding: 0 8px;
            font-family: 'Assistant', sans-serif;
            font-size: 0.875rem;
            color: #0369a1; 
            font-weight: 600;
        }
        .gemini-output-box strong { font-weight: 700; }
        .gemini-output-box ul { list-style-type: disc; margin-right: 1.5rem; }
        .gemini-output-box li { margin-bottom: 0.25rem; }

        .user-project-box {
            background-color: #eff6ff; 
            border: 1px solid #93c5fd; 
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-top: 1.5rem; 
            text-align: right;
        }
        .user-project-box h4 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e40af; 
            margin-bottom: 0.75rem;
        }
        .user-project-box label {
            font-weight: 600;
            color: #1d4ed8; 
        }
        .user-project-box input[type="text"], .user-project-box textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #93c5fd;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
            margin-bottom: 0.75rem;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
        }
        .user-project-guidance {
            background-color: #f0f9ff; 
            border-left: 4px solid #38bdf8; 
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0.375rem;
            font-size: 0.9rem;
            color: #075985; 
            position: relative;
        }
        .learning-focus {
            background-color: #fffbeb; 
            border-left: 4px solid #facc15; 
            padding: 1rem;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 0.375rem;
            font-size: 0.95rem;
            color: #713f12; 
        }
        .learning-focus strong { color: #b45309; }

        .smart-tip {
            background-color: #f0fdf4; 
            border-left: 4px solid #4ade80; 
            padding: 0.75rem;
            margin-top: 1rem;
            border-radius: 0.375rem;
            font-size: 0.9rem;
            color: #15803d; 
        }

        .copy-prompt-button {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            background-color: #38bdf8;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .copy-prompt-button:hover {
            background-color: #0ea5e9;
        }
        .ai-tool-options {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-top: 0.75rem;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
        }
        .copilot-link-button, .gemini-button, .view-larger-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            text-decoration: none;
            transition: background-color 0.3s ease;
            flex-grow: 1; 
        }
         .copilot-link-button {
            background-color: #0078D4; 
        }
        .copilot-link-button:hover {
            background-color: #005A9E; 
        }
        .gemini-button {
             background-color: #10b981; 
             min-width: 220px; 
        }
        .gemini-button:hover {
            background-color: #059669; 
        }
        .view-larger-button {
            background-color: #64748b; 
            font-size: 0.875rem;
            padding: 0.25rem 0.5rem;
            margin-top: 0.5rem;
        }
        .view-larger-button:hover {
            background-color: #475569; 
        }

        .fade-in {
            animation: fadeIn 1s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loading-spinner {
            border: 3px solid #f3f3f3; 
            border-top: 3px solid #3498db; 
            border-radius: 50%;
            width: 16px; 
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 8px;
            vertical-align: middle;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 700px; 
            max-height: 85vh; 
            overflow-y: auto;
            direction: rtl; 
            text-align: right;
        }
        .modal-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1e293b;
        }
        .modal-body {
            font-family: 'Assistant', sans-serif; 
            background-color: #f8fafc;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
            max-height: 65vh; 
            overflow-y: auto;
            line-height: 1.6;
        }
        .modal-body strong { font-weight: 700; }
        .modal-body ul { list-style-type: disc; margin-right: 1.5rem; }
        .modal-body li { margin-bottom: 0.25rem; }
    </style>
</head>
<body class="bg-[#FDFBF8] text-slate-800">

    <header class="fixed top-0 right-0 left-0 bg-white/90 backdrop-blur-md z-50 shadow-sm">
        <div class="h-2.5 bg-gray-200">
            <div id="progress-bar" class="h-full bg-blue-500 transition-all duration-300 w-0"></div>
        </div>
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
             <h1 class="text-xl font-bold text-slate-700">פרויקט: ניהול פגישות יעיל</h1>
             <div id="progress-text" class="text-md font-semibold text-slate-600">שלב 1 מתוך 7</div>
        </div>
    </header>

    <main>
        <section id="step1" class="lesson-section">
            <div class="w-full max-w-3xl text-center space-y-6 fade-in">
                <span class="text-sm font-bold uppercase text-blue-500">שלב 1: הגדרה</span>
                <h2 class="text-4xl md:text-5xl font-bold">הגדרת מטרת הפגישה (שלך!)</h2>
                <div class="intro-paragraph">
                    <p>בינה מלאכותית מעניקה לנו כלים חכמים לתכנון יעיל יותר של משימותינו. בשיעור זה נתמקד בדרכים בהן AI יכול לסייע לנו לארגן פגישות בצורה מיטבית, החל מהשלב הבסיסי ביותר – הגדרת הפגישה. לפני שנצלול לפרקטיקה, נבין כיצד AI יכול לעזור לנו לחדד אפילו את הפרטים הקטנים שאנו לעיתים לוקחים כמובן מאליו, ובכך לשדרג את המקצועיות שלנו. הגדרה ברורה היא המפתח לפגישה מוצלחת שתחסוך זמן לכולם.</p>
                </div>
                
                 <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-right space-y-4 mt-6">
                    <h3 class="text-2xl font-semibold mb-2 text-center">לשם הדגמה: תכנון יום גיבוש</h3>
                    <p class="text-slate-600">כדי להמחיש את התהליך, נשתמש בדוגמה של פגישה לתכנון יום גיבוש:</p>
                    <ul class="list-disc list-inside space-y-1 text-md text-slate-700">
                        <li>**מטרת הפגישה (בדוגמה):** להחליט על תאריך, מקום ותקציב ליום גיבוש.</li>
                        <li>**נושאים עיקריים (בדוגמה):** הצעות למקומות, רעיונות לפעילויות, תאריכים, תקציב.</li>
                        <li>**משתתפים (בדוגמה):** מנהל/ת צוות, נציג/ת רווחה, עובדים מהצוות.</li>
                    </ul>
                </div>

                <div class="user-project-box">
                    <h4>הפרויקט האישי שלך: הגדרת הפגישה</h4>
                    <div>
                        <label for="user-meeting-purpose">1. מהי מטרת הפגישה המרכזית שלך?</label>
                        <input type="text" id="user-meeting-purpose" placeholder="לדוגמה: אישור תקציב לפרויקט חדש, תכנון אירוע קהילתי, סיכום רבעוני">
                    </div>
                    <div>
                        <label for="user-meeting-topics">2. מהם הנושאים העיקריים לדיון בפגישה שלך?</label>
                        <textarea id="user-meeting-topics" rows="3" placeholder="לדוגמה: הצגת נתונים, דיון בחלופות, קבלת החלטות, חלוקת משימות"></textarea>
                    </div>
                    <div>
                        <label for="user-meeting-participants">3. מי המשתתפים ההכרחיים בפגישה שלך?</label>
                        <input type="text" id="user-meeting-participants" placeholder="לדוגמה: מנהל מחלקה, צוות הפרויקט, נציגי לקוחות">
                    </div>

                    <div class="learning-focus">
                        <strong>מוקד למידה:</strong> הגדרת פגישה אפקטיבית היא הבסיס. נסו לחשוב: האם המטרה ברורה ומדידה? האם כל הנושאים הרשומים אכן נחוצים כדי להשיג את המטרה? האם כל המשתתפים הרשומים באמת חייבים להיות שם?
                    </div>

                    <p class="text-slate-700 mt-4 mb-2">רוצה עזרה בשיפור הגדרות הפגישה שלך?</p>
                    <div class="ai-tool-options">
                        <button id="gemini-step1-button" onclick="callGeminiForUserProject('step1_assistance', 'gemini-step1-output', this)" class="gemini-button font-semibold py-2 px-6 rounded-lg transition">✨ קבל הצעות מ-Gemini</button>
                        <a href="https://copilot.microsoft.com/" target="_blank" class="copilot-link-button">פתח את Microsoft Copilot</a>
                    </div>
                     <div id="user-step1-prompt-guidance" class="user-project-guidance mt-3">
                        <button class="copy-prompt-button" onclick="copyToClipboard('step1-prompt-text', this)">העתק הנחיה</button>
                        <p id="step1-prompt-text"><strong>הנחיה לדוגמה ל-AI (מבוססת על מה שהזנת):</strong><br>
אני מגדיר/ה פגישה עם הפרטים הבאים:<br>
מטרה: ""'<strong id="guidance-purpose-s1" class="text-blue-700">[מטרת הפגישה שלך תופיע כאן]</strong>'""<br>
נושאים עיקריים: ""'<strong id="guidance-topics-s1" class="text-blue-700">[הנושאים שלך יופיעו כאן]</strong>'""<br>
משתתפים: ""'<strong id="guidance-participants-s1" class="text-blue-700">[המשתתפים שלך יופיעו כאן]</strong>'""<br><br>
אנא ספק/י 2-3 הצעות קצרות ופשוטות לשיפור הגדרות אלו, או שאל/י שאלת הבהרה אחת או שתיים שיעזרו לי לחשוב על זה. הצג את ההצעות/שאלות בנקודות קצרות (bullet points) תוך שימוש בסימון Markdown בסיסי (למשל, `* הצעה ראשונה`).</p>
                    </div>
                    <div id="gemini-step1-output-container" class="hidden">
                        <div id="gemini-step1-output" class="gemini-output-box"></div>
                        <button onclick="showInModal('gemini-step1-output', 'הצעות מ-Gemini לשיפור הגדרות')" class="view-larger-button">הצג בגדול</button>
                    </div>
                </div>
                <button onclick="saveStep1AndScroll('step2')" class="mt-8 bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-700 transition-transform transform hover:scale-105">שמור והמשך לשלב הבא</button>
            </div>
        </section>

        <section id="step2" class="lesson-section bg-slate-50">
            <div class="w-full max-w-3xl text-center space-y-6 fade-in">
                <span class="text-sm font-bold uppercase text-blue-500">שלב 2: יצירת סדר יום</span>
                <h2 class="text-4xl md:text-5xl font-bold">יצירת אג'נדה בעזרת AI</h2>
                 <div class="intro-paragraph">
                    <p>סדר יום (אג'נדה) הוא עמוד השדרה של כל פגישה מוצלחת. הוא מבטיח שהדיון יישאר ממוקד, שהזמן ינוצל ביעילות ושכל הנושאים החשובים יקבלו התייחסות. בעזרת AI, תהליך יצירת סדר יום, שלעיתים יכול להיות מייגע, הופך לפשוט ומהיר יותר. נלמד כיצד להנחות את ה-AI ליצור עבורנו טיוטה ראשונית חכמה, שתשמש בסיס מצוין לסדר יום מותאם אישית.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-right space-y-4">
                    <h3 class="text-xl font-semibold mb-2 text-center">הדגמה: סדר יום ליום גיבוש</h3>
                    <p class="text-slate-600">זוהי דוגמה לסדר יום עבור פגישת "תכנון יום גיבוש":</p>
                    <button id="agenda-example-button" onclick="showExampleOutput('agenda_example')" class="w-full bg-gray-200 text-slate-800 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition mb-2">הצג דוגמת סדר יום</button>
                    <div id="agenda_example-output-container" class="hidden">
                        <pre id="agenda_example-output" class="example-output-box"></pre>
                    </div>
                </div>
                
                <div class="learning-focus">
                    <strong>מוקד למידה:</strong> כאשר אתם מנחים AI ליצור סדר יום, חשוב להיות כמה שיותר ברורים לגבי מטרת הפגישה והנושאים המרכזיים. ככל שתספקו יותר הקשר, כך ה-AI יוכל ליצור טיוטה רלוונטית יותר. זכרו, זוהי טיוטה – עליכם לעבור עליה, להתאים את חלוקת הזמנים, ולהוסיף פרטים ספציפיים.
                </div>

                <div class="user-project-box">
                    <h4>הפרויקט שלך: יצירת סדר יום עם AI</h4>
                    <p class="text-slate-700 mb-2">תוכל/י לבקש מ-Gemini ליצור טיוטה לסדר היום של הפגישה שלך, או להשתמש ב-Microsoft Copilot.</p>
                    <div class="ai-tool-options">
                        <button id="gemini-step2-button" onclick="callGeminiForUserProject('step2_agenda', 'user-agenda-draft', this)" class="gemini-button font-semibold py-2 px-6 rounded-lg transition">✨ בקש מ-Gemini טיוטה לסדר היום</button>
                        <a href="https://copilot.microsoft.com/" target="_blank" class="copilot-link-button">פתח את Microsoft Copilot</a>
                    </div>
                    <div id="user-agenda-prompt-guidance" class="user-project-guidance">
                        <button class="copy-prompt-button" onclick="copyToClipboard('step2-prompt-text', this)">העתק הנחיה</button>
                        <p id="step2-prompt-text"><strong>הנחיה לדוגמה ל-Microsoft Copilot (מבוססת על מה שהזנת בשלב 1):</strong><br>
אני מארגן/ת פגישה. מטרת הפגישה היא: <strong id="guidance-purpose1" class="text-blue-700">[מטרת הפגישה שלך תופיע כאן]</strong>.<br>
הנושאים העיקריים לדיון הם: <strong id="guidance-topics1" class="text-blue-700">[הנושאים שלך יופיעו כאן]</strong>.<br>
אנא צור טיוטה לסדר יום מפורט לפגישה זו, כולל הצעות לחלוקת זמנים. השתמש בסימון Markdown בסיסי (כותרות מודגשות `**כותרת**`, רשימות עם `* נקודה`).</p>
                    </div>
                    <label for="user-agenda-draft" class="block mt-4">סדר היום לפגישה שלך (ניתן לערוך את הצעת Gemini או להדביק מ-Copilot):</label>
                    <textarea id="user-agenda-draft" rows="5" placeholder="סדר היום שלך יופיע כאן..."></textarea>
                    <button onclick="showInModal('user-agenda-draft', 'סדר היום שלך')" class="view-larger-button mt-1">הצג טיוטת סדר יום בגדול</button>
                    <div class="smart-tip"><strong>טיפ לשימוש חכם:</strong> לאחר קבלת הטיוטה מה-AI, בדקו את חלוקת הזמנים. האם היא ריאלית? האם יש נושאים שדורשים יותר או פחות זמן? התאימו אותה לצרכים שלכם.</div>
                </div>
                <button onclick="scrollToSection('step3')" class="mt-8 bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-700 transition-transform transform hover:scale-105">הבנתי, להזמנות</button>
            </div>
        </section>
        
        <section id="step3" class="lesson-section">
            <div class="w-full max-w-3xl text-center space-y-6 fade-in">
                <span class="text-sm font-bold uppercase text-blue-500">שלב 3: ניסוח הזמנה</span>
                <h2 class="text-4xl md:text-5xl font-bold">ניסוח הזמנה לפגישה עם AI</h2>
                <div class="intro-paragraph">
                    <p>הזמנה מקצועית וברורה לפגישה משקפת את הרצינות והארגון שלנו, ומגדילה את הסיכוי שהמשתתפים יגיעו מוכנים וממוקדים. AI יכול להיות כלי עזר מצוין בניסוח הזמנות כאלה, תוך שהוא דואג לכלול את כל הפרטים הנחוצים ולהתאים את הנימה הנכונה. בואו נראה איך להפוך את משימת ניסוח ההזמנות לקלה ויעילה יותר.</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-right space-y-4">
                    <h3 class="text-xl font-semibold mb-2 text-center">הדגמה: הזמנה ליום גיבוש</h3>
                     <p class="text-slate-600">זוהי דוגמה להזמנה עבור פגישת "תכנון יום גיבוש":</p>
                    <button id="invite-example-button" onclick="showExampleOutput('invite_example')" class="w-full bg-gray-200 text-slate-800 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition mb-2">הצג דוגמת הזמנה</button>
                    <div id="invite_example-output-container" class="hidden">
                        <pre id="invite_example-output" class="example-output-box"></pre>
                    </div>
                </div>

                <div class="learning-focus">
                    <strong>מוקד למידה:</strong> AI יכול לנסח הזמנות במהירות, אך חשוב לוודא שהנימה מתאימה (רשמית/פחות רשמית), שכל הפרטים החשובים כלולים (תאריך, שעה, מיקום, סדר יום), ושיש קריאה ברורה לפעולה (למשל, אישור הגעה). אל תשכחו להתאים את ההזמנה לקהל היעד שלכם.
                </div>

                <div class="user-project-box">
                    <h4>הפרויקט שלך: ניסוח הזמנה עם AI</h4>
                     <p class="text-slate-700 mb-2">תוכל/י לבקש מ-Gemini ליצור טיוטה להזמנה שלך, או להשתמש ב-Microsoft Copilot.</p>
                    <div class="ai-tool-options">
                        <button id="gemini-step3-button" onclick="callGeminiForUserProject('step3_invite', 'user-invite-draft', this)" class="gemini-button font-semibold py-2 px-6 rounded-lg transition">✨ בקש מ-Gemini טיוטה להזמנה</button>
                        <a href="https://copilot.microsoft.com/" target="_blank" class="copilot-link-button">פתח את Microsoft Copilot</a>
                    </div>
                    <div id="user-invite-prompt-guidance" class="user-project-guidance">
                         <button class="copy-prompt-button" onclick="copyToClipboard('step3-prompt-text', this)">העתק הנחיה</button>
                        <p id="step3-prompt-text"><strong>הנחיה לדוגמה ל-Microsoft Copilot:</strong><br>
אנא נסח אימייל הזמנה לפגישה. <br>
מטרת הפגישה: <strong id="guidance-purpose2" class="text-blue-700">[מטרת הפגישה שלך]</strong>.<br>
הפגישה תתקיים בתאריך [הזן את תאריך הפגישה שלך], בשעה [הזן שעה], במיקום [הזן מיקום].<br>
המשתתפים המוזמנים הם: <strong id="guidance-participants" class="text-blue-700">[המשתתפים שלך]</strong>.<br>
סדר היום הוא כדלקמן: [הדבק/י כאן את סדר היום שנוצר לפגישה שלך].<br>
יש לבקש מהמוזמנים לאשר הגעה. השתמש בסימון Markdown בסיסי לעיצוב ההזמנה.</p>
                    </div>
                    <label for="user-invite-draft" class="block mt-4">ההזמנה לפגישה שלך (ניתן לערוך את הצעת Gemini או להדביק מ-Copilot):</label>
                    <textarea id="user-invite-draft" rows="5" placeholder="ההזמנה שלך תופיע כאן..."></textarea>
                     <button onclick="showInModal('user-invite-draft', 'טיוטת ההזמנה שלך')" class="view-larger-button mt-1">הצג טיוטת הזמנה בגדול</button>
                     <div class="smart-tip"><strong>טיפ לשימוש חכם:</strong> האם ההזמנה כוללת את כל המידע הנחוץ למשתתפים כדי להגיע מוכנים? האם ציינתם אם יש צורך בהכנה מוקדמת?</div>
                </div>
                <button onclick="scrollToSection('step4')" class="mt-8 bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-700 transition-transform transform hover:scale-105">הזמנה מוכנה, ליצירת תמלול</button>
            </div>
        </section>

        <section id="step4" class="lesson-section bg-slate-50">
             <div class="w-full max-w-3xl text-center space-y-6 fade-in">
                <span class="text-sm font-bold uppercase text-blue-500">שלב 4: יצירת תמלול מדומיין</span>
                <h2 class="text-4xl md:text-5xl font-bold">יצירת תמלול פגישה מדומיין עם AI</h2>
                <div class="intro-paragraph">
                    <p>כדי לתרגל את יכולות הסיכום של AI, ראשית ניצור 'תמלול מדומיין' – כאילו הפגישה שלך כבר התקיימה. שלב זה חיוני כדי להבין את סוג המידע ש-AI יכול לעבד. AI יכול אפילו לסייע לנו ביצירת תרחישים כאלה, מה שמאפשר לנו להתכונן למגוון מצבים ולשפר את יכולתנו להפיק את המיטב מפגישות אמיתיות. נלמד כיצד לבקש מה-AI ליצור תמלול המשקף דיון מקיף של כ-20 דקות.</p>
                </div>
                
                <div class="learning-focus">
                    <strong>מוקד למידה:</strong> תמלול הוא הבסיס לסיכום פגישה יעיל. כאשר אתם יוצרים תמלול מדומיין, נסו לדמיין את זרימת השיחה, את הנקודות המרכזיות שעולות, ואת ההחלטות או המשימות שנובעות מהדיון. זה יעזור לכם להבין טוב יותר מה לחפש בתמלול אמיתי.
                </div>

                <div class="user-project-box">
                    <h4>הפרויקט שלך: יצירת תמלול מדומיין עם AI</h4>
                    <p class="text-slate-700 mb-2">תוכל/י לבקש מ-Gemini ליצור עבורך תמלול פגישה קצר ומדומיין המבוסס על הגדרות הפגישה שלך, או להשתמש ב-Microsoft Copilot.</p>
                    <div class="ai-tool-options">
                        <button id="gemini-step4-button" onclick="callGeminiForUserProject('step4_transcript', 'user-mock-transcript', this)" class="gemini-button font-semibold py-2 px-6 rounded-lg transition">✨ בקש מ-Gemini תמלול מדומיין</button>
                        <a href="https://copilot.microsoft.com/" target="_blank" class="copilot-link-button">פתח את Microsoft Copilot</a>
                    </div>
                    <div class="user-project-guidance">
                        <button class="copy-prompt-button" onclick="copyToClipboard('step4-prompt-text', this)">העתק הנחיה</button>
                        <p id="step4-prompt-text"><strong>הנחיה לדוגמה ל-Microsoft Copilot:</strong><br>
אנא כתוב תמלול פגישה מדומיין. הפגישה ארכה כ-20 דקות. <br>
מטרת הפגישה היא: <strong id="guidance-purpose-transcript" class="text-blue-700">[מטרת הפגישה שלך]</strong>.<br>
הנושאים העיקריים לדיון הם: <strong id="guidance-topics-transcript" class="text-blue-700">[הנושאים שלך]</strong>.<br>
המשתתפים העיקריים הם: <strong id="guidance-participants-transcript" class="text-blue-700">[המשתתפים שלך]</strong> (ניתן להשתמש בשמות בדויים).<br>
התמלול צריך לשקף דיון שמוביל למספר החלטות ומשימות, ולהיות באורך המתאים לפגישה של 20 דקות. השתמש בסימון Markdown בסיסי לעיצוב התמלול (למשל, `**שם הדובר:** טקסט`).</p>
                    </div>
                    <label for="user-mock-transcript" class="block mt-4">התמלול המדומיין של הפגישה שלך (ניתן לערוך את הצעת Gemini או להדביק מ-Copilot):</label>
                    <textarea id="user-mock-transcript" rows="8" placeholder="התמלול המדומיין שלך יופיע כאן..."></textarea>
                    <button onclick="showInModal('user-mock-transcript', 'התמלול המדומיין שלך')" class="view-larger-button mt-1">הצג תמלול בגדול</button>
                    <div class="smart-tip"><strong>טיפ לשימוש חכם:</strong> כאשר אתם מבקשים מ-AI ליצור תמלול מדומיין, נסו לתת לו 'אישיות' למשתתפים או כיוון כללי לדיון כדי שהתמלול יהיה יותר מציאותי ושימושי לשלב הסיכום.</div>
                </div>
                <button onclick="scrollToSection('step5')" class="mt-8 bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-700 transition-transform transform hover:scale-105">תמלול מוכן, לסיכום</button>
            </div>
        </section>
        
        <section id="step5" class="lesson-section">
             <div class="w-full max-w-3xl text-center space-y-6 fade-in">
                <span class="text-sm font-bold uppercase text-blue-500">שלב 5: סיכום פרוטוקול</span>
                <h2 class="text-4xl md:text-5xl font-bold">סיכום הפגישה שלך בעזרת AI</h2>
                <div class="intro-paragraph">
                    <p>אחד האתגרים הגדולים לאחר פגישה הוא להפיק ממנה סיכום (פרוטוקול) ברור, תמציתי ומדויק, שיתפוס את כל ההחלטות והמשימות החשובות. AI מציע כאן פתרון מהפכני, ביכולתו לעבד כמויות גדולות של טקסט (כמו תמלול פגישה) ולזקק ממנו את העיקר. נלמד כיצד להנחות את ה-AI לסכם עבורנו את התמלול שיצרנו, ולהפוך מידע רב לסיכום מעשי.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-right space-y-4">
                    <h3 class="text-xl font-semibold mb-2 text-center">הדגמה: סיכום פגישת יום גיבוש</h3>
                    <p class="text-slate-600">זוהי דוגמה לסיכום פגישה עבור "תכנון יום גיבוש", המבוסס על תמלול הדוגמה:</p>
                     <button id="summary-example-button" onclick="showExampleOutput('summary_example')" class="w-full bg-gray-200 text-slate-800 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition mb-2">הצג דוגמת סיכום</button>
                    <div id="summary_example-output-container" class="hidden">
                        <pre id="summary_example-output" class="example-output-box"></pre>
                    </div>
                </div>

                <div class="learning-focus">
                    <strong>מוקד למידה:</strong> סיכום טוב צריך לתפוס את ההחלטות המרכזיות ואת המשימות שחולקו. כאשר אתם משתמשים ב-AI לסיכום תמלול, ודאו שהוא לא השמיט פרטים קריטיים או 'הוסיף' מידע שלא היה. אתם האחראים על דיוק הסיכום.
                </div>

                <div class="user-project-box">
                    <h4>הפרויקט שלך: סיכום הפגישה שלך עם AI</h4>
                    <p class="text-slate-700 mb-2">העתק/י את התמלול המדומיין שיצרת בשלב הקודם (או את הנקודות העיקריות שלו) לתיבת הטקסט למטה, ואז בקש/י מ-Gemini לסכם אותו, או השתמש/י ב-Microsoft Copilot עם הנחיה דומה.</p>
                    <label for="user-transcript-for-summary" class="block mt-4">התמלול המדומיין שלך (לצורך סיכום):</label>
                    <textarea id="user-transcript-for-summary" rows="6" placeholder="הדבק/י כאן את התמלול המדומיין מהשלב הקודם..."></textarea>
                    <div class="ai-tool-options">
                        <button id="gemini-step5-button" onclick="callGeminiForUserProject('step5_summary', 'user-summary-notes', this)" class="gemini-button font-semibold py-2 px-6 rounded-lg transition">✨ סכם את התמלול עם Gemini</button>
                        <a href="https://copilot.microsoft.com/" target="_blank" class="copilot-link-button">פתח את Microsoft Copilot</a>
                    </div>
                    <div class="user-project-guidance">
                        <button class="copy-prompt-button" onclick="copyToClipboard('step5-prompt-text', this)">העתק הנחיה</button>
                        <p id="step5-prompt-text"><strong>הנחיה לדוגמה ל-Microsoft Copilot (לאחר שהדבקת לו את התמלול שלך):</strong><br>
אנא סכם את תמלול הפגישה שהדבקתי. התמקד/י בהחלטות המרכזיות שהתקבלו ובמשימות שחולקו, כולל מי אחראי על כל משימה ותאריכי יעד אם נקבעו. הצג את הסיכום במבנה ברור עם כותרות מודגשות (למשל, `**החלטות עיקריות**`, `**משימות להמשך**`) ונקודות (`* נקודה`).</p>
                    </div>
                     <label for="user-summary-notes" class="block mt-4">סיכום הפגישה שלך (ניתן לערוך את הצעת Gemini או להדביק מ-Copilot):</label>
                    <textarea id="user-summary-notes" rows="4" placeholder="סיכום הפגישה שלך יופיע כאן..."></textarea>
                    <button onclick="showInModal('user-summary-notes', 'סיכום הפגישה שלך')" class="view-larger-button mt-1">הצג סיכום בגדול</button>
                    <div class="smart-tip"><strong>טיפ לשימוש חכם:</strong> האם הסיכום של ה-AI באמת תופס את "רוח הדברים"? האם הוא מנוסח בצורה שתהיה ברורה לכל מי שלא נכח בפגישה? אל תהססו לערוך ולהוסיף הבהרות.</div>
                </div>
                <button onclick="scrollToSection('step6')" class="mt-8 bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-700 transition-transform transform hover:scale-105">סיכום מעולה, למייל הסיכום</button>
            </div>
        </section>

        <section id="step6" class="lesson-section bg-slate-50">
            <div class="w-full max-w-3xl text-center space-y-6 fade-in">
                <span class="text-sm font-bold uppercase text-blue-500">שלב 6: מייל סיכום</span>
                <h2 class="text-4xl md:text-5xl font-bold">ניסוח מייל סיכום פגישה עם AI</h2>
                <div class="intro-paragraph">
                    <p>שליחת מייל סיכום מסודר היא הדרך הטובה ביותר לוודא שכל המשתתפים מעודכנים לגבי מה שהוחלט ומהן המשימות להמשך. AI יכול לסייע בניסוח מייל כזה בצורה מקצועית ויעילה, תוך שהוא מתבסס על סיכום הפגישה. שלב זה חותם את תהליך ניהול הפגישה ומשדר מקצועיות ואחריות.</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-right space-y-4">
                    <h3 class="text-xl font-semibold mb-2 text-center">הדגמה: מייל סיכום ליום גיבוש</h3>
                     <p class="text-slate-600">זוהי דוגמה למייל סיכום עבור פגישת "תכנון יום גיבוש":</p>
                    <button id="email-example-button" onclick="showExampleOutput('email_example')" class="w-full bg-gray-200 text-slate-800 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition mb-2">הצג דוגמת מייל סיכום</button>
                    <div id="email_example-output-container" class="hidden">
                        <pre id="email_example-output" class="example-output-box"></pre>
                    </div>
                </div>
                
                <div class="learning-focus">
                    <strong>מוקד למידה:</strong> מייל סיכום צריך להיות ברור, תמציתי, ולכלול את כל המידע החשוב מהסיכום. בדקו שה-AI שמר על נימה מקצועית והתמקד בעיקר. תמיד בצעו הגהה לפני השליחה.
                </div>

                 <div class="user-project-box">
                    <h4>הפרויקט שלך: ניסוח מייל סיכום לפגישה שלך עם AI</h4>
                    <p class="text-slate-700 mb-2">העתק/י את סיכום הפגישה שלך מהשלב הקודם לתיבת הטקסט למטה, ואז בקש/י מ-Gemini ליצור טיוטה למייל, או השתמש/י ב-Microsoft Copilot.</p>
                    <label for="user-summary-for-email" class="block mt-4">סיכום הפגישה שלך (לצורך ניסוח המייל):</label>
                    <textarea id="user-summary-for-email" rows="6" placeholder="הדבק/י כאן את סיכום הפגישה שלך מהשלב הקודם..."></textarea>
                    <div class="ai-tool-options">
                        <button id="gemini-step6-button" onclick="callGeminiForUserProject('step6_email', 'user-email-draft', this)" class="gemini-button font-semibold py-2 px-6 rounded-lg transition">✨ בקש מ-Gemini טיוטה למייל</button>
                        <a href="https://copilot.microsoft.com/" target="_blank" class="copilot-link-button">פתח את Microsoft Copilot</a>
                    </div>
                    <div class="user-project-guidance">
                        <button class="copy-prompt-button" onclick="copyToClipboard('step6-prompt-text', this)">העתק הנחיה</button>
                        <p id="step6-prompt-text"><strong>הנחיה לדוגמה ל-Microsoft Copilot:</strong><br>
אנא נסח אימייל מקצועי למשתתפי הפגישה בנושא '<strong id="guidance-purpose3" class="text-blue-700">[מטרת הפגישה שלך]</strong>'.<br>
האימייל צריך לכלול את סיכום ההחלטות והמשימות הבא: [הדבק/י כאן את סיכום הפגישה שלך].<br>
האימייל צריך להודות למשתתפים ולציין שיש לעקוב אחר המשימות. השתמש בסימון Markdown בסיסי לעיצוב המייל.</p>
                    </div>
                    <label for="user-email-draft" class="block mt-4">מייל הסיכום שלך (ניתן לערוך את הצעת Gemini או להדביק מ-Copilot):</label>
                    <textarea id="user-email-draft" rows="5" placeholder="מייל הסיכום שלך יופיע כאן..."></textarea>
                    <button onclick="showInModal('user-email-draft', 'טיוטת מייל הסיכום שלך')" class="view-larger-button mt-1">הצג טיוטת מייל בגדול</button>
                    <div class="smart-tip"><strong>טיפ לשימוש חכם:</strong> לפני שליחת המייל, קראו אותו מנקודת מבט של מישהו שלא מכיר את כל הפרטים. האם הוא מובן? האם חסר משהו?</div>
                </div>
                <button onclick="scrollToSection('step7')" class="mt-8 bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-700 transition-transform transform hover:scale-105">כמעט סיימנו, לחשיבה אתית</g>
            </div>
        </section>

        <section id="step7" class="lesson-section bg-slate-50">
            <div class="w-full max-w-3xl text-center space-y-6 fade-in">
                <span class="text-sm font-bold uppercase text-blue-500">שלב 7: חשיבה אתית</span>
                <h2 class="text-4xl md:text-5xl font-bold">שימוש אחראי ב-AI</h2>
                <div class="intro-paragraph">
                    <p>ככל שאנו משלבים יותר ויותר כלי AI בעבודתנו, כך גוברת החשיבות של שימוש מושכל ואתי בכלים אלו. בפרק זה, נתמקד בהיבטים האתיים של שימוש ב-AI לניהול פגישות, כגון פרטיות, דיוק ואחריות. הבנה של נקודות אלו תאפשר לנו למצות את הפוטנציאל של AI תוך שמירה על עקרונות מקצועיים וערכיים.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-right space-y-4">
                    <h3 class="text-xl font-semibold mb-2">נקודות כלליות למחשבה:</h3>
                    <ul class="list-disc list-inside space-y-2 text-lg">
                        <li>**פרטיות וסודיות:** ודא/י שהמידע המוזן לכלי AI (במיוחד כלים מקוונים כמו Microsoft Copilot או Gemini) אינו רגיש מדי, אלא אם הכלי מאושר על ידי הארגון שלך ומבטיח אבטחת מידע בהתאם למדיניות הארגון. קרא/י את תנאי השימוש של הכלי.</li>
                        <li>**דיוק ואחריות:** AI יכול לטעות. האחריות על התוכן הסופי (סדר יום, הזמנה, סיכום) היא תמיד שלך. בדוק/בדקי היטב כל פלט של AI.</li>
                        <li>**שקיפות:** האם יש ליידע משתתפים אם פגישה מוקלטת או מסוכמת אוטומטית על ידי AI? בדרך כלל, כן.</li>
                    </ul>
                </div>

                <div class="user-project-box">
                    <h4>הפרויקט שלך: היבטים אתיים</h4>
                    <label for="user-ethics-reflection" class="block text-lg font-semibold text-center mb-2">שאלה למחשבה אישית:</label>
                    <p class="text-slate-700 text-center mb-3">בהתחשב בפגישה שתיארת בפרויקט *שלך* (עם המטרה <strong id="guidance-purpose-ethics" class="text-blue-700">[מטרת הפגישה שלך]</strong>), איזה שיקול אתי מהנקודות שלמעלה (או שיקול אחר) הוא הרלוונטי והחשוב ביותר עבורך בעת שימוש בכלי כמו Microsoft Copilot או Gemini, ומדוע?</p>
                    <textarea id="user-ethics-reflection" rows="4" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="כתבו כאן את מחשבותיכם..."></textarea>
                </div>

                <div class="mt-8">
                     <h3 class="text-3xl font-bold text-green-600">כל הכבוד! סיימתם את הפרויקט בהצלחה!</h3>
                     <p class="text-xl mt-2 text-slate-600">תרגלתם את כל השלבים לניהול פגישה יעיל בעזרת AI, תוך התייחסות לפרויקט אישי משלכם והכוונה לשימוש ב-Microsoft Copilot ו-Gemini.</p>
                     <p class="text-lg mt-1 text-slate-500">אתם מוכנים להשתמש בידע הזה בעבודה היומיומית!</p>
                </div>
            </div>
        </section>
    </main>

    <div id="aiResponseModal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-2xl font-semibold">תגובת AI</h3>
                <button onclick="closeModal()" class="text-2xl font-bold text-slate-500 hover:text-slate-700">&times;</button>
            </div>
            <div id="modalBody" class="modal-body">
                </div>
        </div>
    </div>

    <script>
    const userProjectData = {
        purpose: '',
        topics: '',
        participants: '',
        agendaDraft: '',
        inviteDraft: '',
        mockTranscript: '',
        summaryNotes: '',
        emailDraft: ''
    };
    
    const exampleOutputs = {
        agenda_example: `**סדר יום מוצע לפגישת "תכנון יום גיבוש לעובדים"**

* **1. פתיחה וסקירת מטרות הפגישה (5 דקות)**
    * ברכות והצגת מטרת העל: תכנון יום גיבוש מוצלח.
* **2. הצגת הצעות למקומות ופעילויות (15 דקות)**
    * דיון פתוח על היתרונות והחסרונות של כל הצעה.
* **3. בדיקת תאריכים אפשריים (10 דקות)**
    * סקירת לוחות זמנים והעדפות.
* **4. דיון בנושא תקציב (10 דקות)**
    * הצגת מסגרת התקציב ודיון על עלויות.
* **5. החלטות וחלוקת משימות (15 דקות)**
    * בחירת כיוון מועדף והגדרת אחראים.
* **6. סיכום וצעדים הבאים (5 דקות)**
    * חזרה על החלטות ומשימות.`,
        invite_example: `**נושא: הזמנה לפגישת תכנון יום גיבוש לעובדים**

שלום לכולם,

הנכם מוזמנים לפגישת צוות בנושא תכנון יום הגיבוש השנתי שלנו.
מטרת הפגישה היא לקבל החלטות לגבי התאריך, המקום והתקציב של יום הגיבוש.

**הפגישה תתקיים בפרטים הבאים:**
* תאריך: יום שני, 16 ביוני 2025
* שעה: 10:00 - 11:00 (משוער)
* מיקום: חדר ישיבות "נועם"

סדר היום מצורף להזמנה זו.
נא אשרו הגעתכם עד לתאריך [לדוגמה: 10 ביוני 2025].

מצפה לראותכם,
[שם השולח/ת]`,
        summary_example: `**סיכום פגישת "תכנון יום גיבוש לעובדים"**

**החלטות עיקריות:**
* **מיקום מועדף:** ירושלים.
* **פעילות מרכזית מועדפת:** סדנת בישול.
* **תקופה מועדפת:** השבוע השלישי של יולי (בכפוף לבדיקת זמינות סופית).
* **מסגרת תקציב מאושרת:** עד 5000 ש"ח.

**משימות וגורמים אחראים:**
* **שרה:** בדיקת הצעות מחיר לסדנאות בישול בירושלים לאמצע יולי.
* **משה:** שליחת מייל לכל העובדים לווידוא זמינות סופית בשבוע השלישי של יולי.
* **יוסי:** הכנת טיוטת לוח זמנים ליום הגיבוש.`,
        email_example: `**נושא: סיכום פגישת תכנון יום גיבוש**

שלום לצוות,

בהמשך לפגישתנו היום בנושא תכנון יום הגיבוש, להלן עיקרי הדברים וההחלטות שהתקבלו:

**החלטות עיקריות:**
* מיקום מועדף ליום הגיבוש: ירושלים.
* פעילות מרכזית מועדפת: סדנת בישול.
* תקופה מועדפת: השבוע השלישי של יולי (בכפוף לבדיקת זמינות סופית).
* מסגרת תקציב מאושרת: עד 5000 ש"ח.

**משימות וגורמים אחראים:**
* שרה: בדיקת הצעות מחיר לסדנאות בישול.
* משה: שליחת מייל לווידוא זמינות.
* יוסי: הכנת טיוטת לו"ז.

אנו מודים לכולכם על ההשתתפות הפעילה והתרומה לדיון.
נא ודאו שאתם מעודכנים לגבי המשימות שהוטלו עליכם.

בברכה,
[שם מסכם הפגישה/מנהל הפרויקט]`
    };

    function showExampleOutput(type) {
        const outputEl = document.getElementById(`${type}-output`);
        const container = document.getElementById(`${type}-output-container`);
        const button = document.getElementById(`${type}-button`);
        
        if (!outputEl || !container) return;
        outputEl.innerHTML = simpleMarkdownToHtml(exampleOutputs[type]); 
        container.classList.toggle('hidden'); 
        if (button) {
            const exampleTypeDisplay = type.replace('_example', '');
            let buttonText = '';
            switch(exampleTypeDisplay) {
                case 'agenda': buttonText = 'סדר יום'; break;
                case 'invite': buttonText = 'הזמנה'; break;
                case 'summary': buttonText = 'סיכום'; break;
                case 'email': buttonText = 'מייל סיכום'; break;
                default: buttonText = 'דוגמה';
            }
            button.innerText = container.classList.contains('hidden') ? `הצג דוגמת ${buttonText}` : `הסתר דוגמה`;
        }
    }

    const modal = document.getElementById('aiResponseModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');

    function simpleMarkdownToHtml(markdown) {
        if (typeof markdown !== 'string') return '';
        let html = markdown;
        // Bold: **text** or __text__
        html = html.replace(/\*\*(.*?)\*\*|__(.*?)__/g, '<strong>$1$2</strong>');
        // Italics: *text* or _text_
        html = html.replace(/\*(.*?)\*|_(.*?)_/g, '<em>$1$2</em>');
        // Unordered lists: * item, - item, or + item
        html = html.split('\n').map(line => {
            line = line.trim();
            if (line.startsWith('* ') || line.startsWith('- ') || line.startsWith('+ ')) {
                return `<li>${line.substring(2)}</li>`;
            }
            return line;
        }).join('\n'); 

        html = html.replace(/(<li>.*?<\/li>\s*)+/gs, (match) => `<ul>${match.replace(/\n/g, '')}</ul>`);
        
        html = html.replace(/\n/g, '<br>');
        return html;
    }

    function showInModal(sourceElementId, title) {
        const sourceElement = document.getElementById(sourceElementId);
        if (sourceElement && modal && modalTitle && modalBody) {
            let contentToDisplay;
            if (sourceElement.tagName === 'TEXTAREA') {
                contentToDisplay = simpleMarkdownToHtml(sourceElement.value);
            } else if (sourceElement.classList.contains('gemini-output-box')) {
                contentToDisplay = sourceElement.innerHTML; 
            } else {
                contentToDisplay = simpleMarkdownToHtml(sourceElement.innerText);
            }
            
            modalTitle.innerText = title;
            modalBody.innerHTML = contentToDisplay;
            modal.classList.add('active');
        }
    }

    function closeModal() {
        if (modal) {
            modal.classList.remove('active');
        }
    }
    if (modal) {
        modal.addEventListener('click', (event) => {
            if (event.target === modal) {
                closeModal();
            }
        });
    }
    async function callGeminiAPI(prompt, outputElementOrTextareaId, buttonElement) {
        const outputEl = document.getElementById(outputElementOrTextareaId);
        if (!outputEl) return;

        const originalButtonText = buttonElement.dataset.originalText || buttonElement.innerHTML;
        if (!buttonElement.dataset.originalText) {
             buttonElement.dataset.originalText = originalButtonText;
        }
        buttonElement.innerHTML = `מעבד... <div class="loading-spinner"></div>`;
        buttonElement.disabled = true;
        
        let displayContainer;
        if (outputEl.tagName === 'PRE' || outputEl.classList.contains('gemini-output-box')) { 
            displayContainer = outputEl.parentElement;
            if(displayContainer) displayContainer.classList.remove('hidden');
            outputEl.innerHTML = '<div class="text-center text-slate-500 p-4">טוען הצעה מ-AI...</div>';
        } else { 
            outputEl.value = 'טוען הצעה מ-AI...';
        }

        // !!! שינוי מרכזי כאן: הכתובת של ה-Backend שלך !!!
        // כשתעלה את ה-backend לרשת, החלף את הכתובת המקומית בכתובת של השרת החיצוני שלך
        const backendApiUrl = 'http://localhost:3000/api/gemini'; // לפיתוח מקומי
        // const backendApiUrl = 'https://your-deployed-backend-url.com/api/gemini'; // לדוגמה אחרי העלאה לרשת

        try {
            const response = await fetch(backendApiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ prompt: prompt }) // שלח את ההנחיה בגוף הבקשה
            });

            if (!response.ok) {
                const errorResult = await response.json();
                console.error('Backend API Error:', errorResult);
                throw new Error(`שגיאה מהשרת שלך: ${response.status} ${response.statusText}. פרטים: ${errorResult.error || errorResult.message}`);
            }

            const result = await response.json();
            // ה-backend שלי מחזיר אובייקט עם שדה generatedText
            let generatedText = result.generatedText || "לא התקבלה תשובה ברורה מה-AI. נסו שוב מאוחר יותר או עם הנחיה אחרת.";
            
            const formattedHtml = simpleMarkdownToHtml(generatedText);

            if (outputEl.tagName === 'PRE' || outputEl.classList.contains('gemini-output-box')) {
                outputEl.innerHTML = formattedHtml; 
            } else { 
                outputEl.value = generatedText; 
            }
            
            buttonElement.innerHTML = "✨ הצעה התקבלה מ-AI";
            // עדכון userProjectData נשאר כפי שהיה...
            if (outputElementOrTextareaId === 'user-agenda-draft') userProjectData.agendaDraft = generatedText;
            else if (outputElementOrTextareaId === 'user-invite-draft') userProjectData.inviteDraft = generatedText;
            else if (outputElementOrTextareaId === 'user-mock-transcript') {
                userProjectData.mockTranscript = generatedText;
                const transcriptForSummaryEl = document.getElementById('user-transcript-for-summary');
                if (transcriptForSummaryEl) transcriptForSummaryEl.value = generatedText; 
            }
            else if (outputElementOrTextareaId === 'user-summary-notes') {
                userProjectData.summaryNotes = generatedText;
                const summaryForEmailEl = document.getElementById('user-summary-for-email');
                if (summaryForEmailEl) summaryForEmailEl.value = generatedText; 
            }
            else if (outputElementOrTextareaId === 'user-email-draft') userProjectData.emailDraft = generatedText;


            setTimeout(() => {
                buttonElement.innerHTML = originalButtonText;
                buttonElement.disabled = false;
            }, 3000);

        } catch (error) {
            console.error('Fetch Error:', error);
            const errorMessage = `אירעה שגיאה: ${error.message}. אנא בדקו את חיבור האינטרנט ונסו שוב.`;
            if (outputEl.tagName === 'PRE' || outputEl.classList.contains('gemini-output-box')) {
                outputEl.innerHTML = `<div class="text-red-600 p-4">${errorMessage}</div>`;
            } else {
                outputEl.value = errorMessage;
            }
            buttonElement.innerHTML = "שגיאה, נסה שוב";
            buttonElement.disabled = false;
        }
    }

    function callGeminiForUserProject(actionType, outputElementId, buttonElem) {
        const buttonElement = buttonElem || event.target; 
        let prompt = "";

        userProjectData.purpose = document.getElementById('user-meeting-purpose')?.value || userProjectData.purpose;
        userProjectData.topics = document.getElementById('user-meeting-topics')?.value || userProjectData.topics;
        userProjectData.participants = document.getElementById('user-meeting-participants')?.value || userProjectData.participants;
        userProjectData.agendaDraft = document.getElementById('user-agenda-draft')?.value || userProjectData.agendaDraft;
        userProjectData.mockTranscript = document.getElementById('user-mock-transcript')?.value || userProjectData.mockTranscript;
        userProjectData.summaryNotes = document.getElementById('user-summary-notes')?.value || userProjectData.summaryNotes;


        switch (actionType) {
            case 'step1_assistance':
                prompt = `אני מגדיר/ה פגישה עם הפרטים הבאים:
מטרה: "${userProjectData.purpose}"
נושאים עיקריים: "${userProjectData.topics}"
משתתפים: "${userProjectData.participants}"

אנא ספק/י 2-3 **הצעות קצרות ופשוטות** לשיפור הגדרות אלו. התמקד/י בדרכים להפוך את המטרה ליותר ממוקדת, את הנושאים ליותר ברורים, או את רשימת המשתתפים ליעילה יותר. אפשר גם לשאול **שאלת הבהרה אחת או שתיים** שיעזרו לי לחשוב על זה. הצג את ההצעות/שאלות בנקודות קצרות (bullet points) תוך שימוש בסימון Markdown בסיסי (למשל, השתמש ב- '*' לתבליט ו- '**' להדגשה).`;
                break;
            case 'step2_agenda':
                prompt = `אני מארגן/ת פגישה. מטרת הפגישה היא: "${userProjectData.purpose}". הנושאים העיקריים לדיון הם: "${userProjectData.topics}".
אנא צור טיוטה לסדר יום מפורט לפגישה זו, כולל הצעות לחלוקת זמנים. השתמש בסימון Markdown בסיסי (כותרות מודגשות עם '**', רשימות עם '*') לעיצוב סדר היום.`;
                break;
            case 'step3_invite':
                const agendaForInvite = userProjectData.agendaDraft || "סדר יום יפורט בהמשך או יצורף להזמנה";
                prompt = `אנא נסח אימייל הזמנה מקצועי לפגישה.
מטרת הפגישה: "${userProjectData.purpose}".
הפגישה תתקיים בתאריך [הכנס/י תאריך], בשעה [הכנס/י שעה], במיקום [הכנס/י מיקום].
המשתתפים המוזמנים הם: "${userProjectData.participants}".
סדר היום הוא כדלקמן:
---
${agendaForInvite}
---
יש לבקש מהמוזמנים לאשר הגעה. החתום על ההזמנה הוא [שמך/שם השולח]. השתמש בסימון Markdown בסיסי (הדגשות עם '**') לעיצוב ההזמנה.`;
                break;
            case 'step4_transcript':
                 prompt = `אני מבקש/ת ליצור תמלול פגישה מדומיין. הפגישה צריכה לשקף דיון של כ-20 דקות.
מטרת הפגישה היא: "${userProjectData.purpose}".
הנושאים העיקריים לדיון הם: "${userProjectData.topics}".
המשתתפים העיקריים בפגישה (ניתן להשתמש בשמות בדויים, למשל, ראובן, שמעון, לוי): "${userProjectData.participants}".
התמלול צריך לשקף דיון שמוביל למספר החלטות ומשימות הקשורות לנושאי הפגישה. אנא השתמש בשמות המשתתפים כדי לציין מי אמר כל דבר. השתמש בסימון Markdown בסיסי לעיצוב התמלול (למשל, הדגשת שמות הדוברים עם '**שם הדובר:**').`;
                break;
            case 'step5_summary':
                const transcriptToSummarize = document.getElementById('user-transcript-for-summary')?.value;
                if (!transcriptToSummarize) {
                    alert("אנא הדבק/י או כתוב/י תמלול מדומיין תחילה בשלב 4, או כאן.");
                    buttonElement.innerHTML = buttonElement.dataset.originalText || "✨ סכם את התמלול שלי עם Gemini";
                    buttonElement.disabled = false;
                    return;
                }
                prompt = `אנא סכם את תמלול הפגישה הבא. התמקד בהחלטות המרכזיות שהתקבלו ובמשימות שחולקו, כולל מי אחראי על כל משימה ותאריכי יעד אם צוינו בתמלול. הצג את הסיכום במבנה ברור עם כותרות מודגשות (למשל, '**החלטות עיקריות**', '**משימות להמשך**') ונקודות ('* נקודה'). השתמש בסימון Markdown בסיסי.
---
${transcriptToSummarize}
---`;
                break;
            case 'step6_email':
                const summaryForEmail = document.getElementById('user-summary-for-email')?.value;
                 if (!summaryForEmail) {
                    alert("אנא הדבק/י או כתוב/י את סיכום הפגישה שלך תחילה בשלב 5, או כאן.");
                    buttonElement.innerHTML = buttonElement.dataset.originalText || "✨ בקש מ-Gemini טיוטה למייל סיכום";
                    buttonElement.disabled = false;
                    return;
                }
                prompt = `אנא נסח אימייל מקצועי למשתתפי פגישה בנושא "${userProjectData.purpose}".
האימייל צריך לכלול את סיכום ההחלטות והמשימות הבא:
---
${summaryForEmail}
---
האימייל צריך להודות למשתתפים ולציין שיש לעקוב אחר המשימות. החתום על המייל הוא [שמך/שם שולח המייל]. השתמש בסימון Markdown בסיסי (הדגשות עם '**') לעיצוב המייל.`;
                break;
            default:
                console.error("Unknown action type for user project Gemini call:", actionType);
                return;
        }
        if (!buttonElement.dataset.originalText) { 
             buttonElement.dataset.originalText = buttonElement.innerHTML;
        }
        callGeminiAPI(prompt, outputElementId, buttonElement);
    }
    
    const sections = document.querySelectorAll('.lesson-section');
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');

    function updateProgress() {
        let currentSectionIndex = 0;
        sections.forEach((section, index) => {
            const rect = section.getBoundingClientRect();
            if (rect.top < window.innerHeight * 0.6 && rect.bottom > 0) {
                currentSectionIndex = index;
            }
        });
        
        const totalSteps = sections.length;
        const progressPercentage = ((currentSectionIndex + 1) / totalSteps) * 100;
        progressBar.style.width = `${progressPercentage}%`;
        progressText.innerText = `שלב ${currentSectionIndex + 1} מתוך ${totalSteps}`;
    }
    
    window.addEventListener('scroll', updateProgress);
    document.addEventListener('DOMContentLoaded', () => {
        updateProgress(); 
        if (document.getElementById('user-meeting-purpose')) {
            updateGuidanceFields();
        }
        document.getElementById('agenda-example-button')?.addEventListener('click', () => showExampleOutput('agenda_example'));
        document.getElementById('invite-example-button')?.addEventListener('click', () => showExampleOutput('invite_example'));
        document.getElementById('summary-example-button')?.addEventListener('click', () => showExampleOutput('summary_example'));
        document.getElementById('email-example-button')?.addEventListener('click', () => showExampleOutput('email_example'));

        const userAgendaDraft = document.getElementById('user-agenda-draft');
        if(userAgendaDraft) {
            userAgendaDraft.addEventListener('input', () => {
                userProjectData.agendaDraft = userAgendaDraft.value;
            });
        }
        
        const userMockTranscript = document.getElementById('user-mock-transcript');
        const userTranscriptForSummary = document.getElementById('user-transcript-for-summary');
        if(userMockTranscript && userTranscriptForSummary) {
            userMockTranscript.addEventListener('input', () => {
                userProjectData.mockTranscript = userMockTranscript.value;
                userTranscriptForSummary.value = userProjectData.mockTranscript; 
            });
        }
         if(userTranscriptForSummary && userMockTranscript) { 
            userTranscriptForSummary.addEventListener('input', () => {
                userProjectData.mockTranscript = userTranscriptForSummary.value;
                 if(userMockTranscript) userMockTranscript.value = userProjectData.mockTranscript;
            });
        }

        const userSummaryNotes = document.getElementById('user-summary-notes');
        const userSummaryForEmail = document.getElementById('user-summary-for-email');
        if(userSummaryNotes && userSummaryForEmail) {
            userSummaryNotes.addEventListener('input', () => {
                userProjectData.summaryNotes = userSummaryNotes.value;
                userSummaryForEmail.value = userProjectData.summaryNotes; 
            });
        }
        if(userSummaryForEmail && userSummaryNotes) { 
            userSummaryForEmail.addEventListener('input', () => {
                userProjectData.summaryNotes = userSummaryForEmail.value;
                 if(userSummaryNotes) userSummaryNotes.value = userProjectData.summaryNotes;
            });
        }
    });
    
    function scrollToSection(sectionId) {
        const sectionElement = document.getElementById(sectionId);
        if (sectionElement) {
            sectionElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }

    function saveStep1AndScroll(nextSectionId) {
        userProjectData.purpose = document.getElementById('user-meeting-purpose').value;
        userProjectData.topics = document.getElementById('user-meeting-topics').value;
        userProjectData.participants = document.getElementById('user-meeting-participants').value;
        
        updateGuidanceFields();
        scrollToSection(nextSectionId);
    }

    function updateGuidanceFields() {
        const purposeText = userProjectData.purpose || "[מטרת הפגישה שלך]";
        const topicsText = userProjectData.topics || "[הנושאים שלך]";
        const participantsText = userProjectData.participants || "[המשתתפים שלך]";

        const el_guidance_purpose_s1 = document.getElementById('guidance-purpose-s1');
        if (el_guidance_purpose_s1) el_guidance_purpose_s1.textContent = purposeText;
        const el_guidance_topics_s1 = document.getElementById('guidance-topics-s1');
        if (el_guidance_topics_s1) el_guidance_topics_s1.textContent = topicsText;
        const el_guidance_participants_s1 = document.getElementById('guidance-participants-s1');
        if (el_guidance_participants_s1) el_guidance_participants_s1.textContent = participantsText;

        const el_guidance_purpose1 = document.getElementById('guidance-purpose1');
        if (el_guidance_purpose1) el_guidance_purpose1.textContent = purposeText;
        
        const el_guidance_topics1 = document.getElementById('guidance-topics1');
        if (el_guidance_topics1) el_guidance_topics1.textContent = topicsText;

        const el_guidance_purpose2 = document.getElementById('guidance-purpose2');
        if (el_guidance_purpose2) el_guidance_purpose2.textContent = purposeText;

        const el_guidance_participants = document.getElementById('guidance-participants');
        if (el_guidance_participants) el_guidance_participants.textContent = participantsText;
        
        const el_guidance_purpose3 = document.getElementById('guidance-purpose3');
        if (el_guidance_purpose3) el_guidance_purpose3.textContent = purposeText;
        
        const el_guidance_purpose_ethics = document.getElementById('guidance-purpose-ethics');
        if (el_guidance_purpose_ethics) el_guidance_purpose_ethics.textContent = purposeText;
        
        const el_guidance_purpose_transcript = document.getElementById('guidance-purpose-transcript');
        if (el_guidance_purpose_transcript) el_guidance_purpose_transcript.textContent = purposeText;
        
        const el_guidance_topics_transcript = document.getElementById('guidance-topics-transcript');
        if (el_guidance_topics_transcript) el_guidance_topics_transcript.textContent = topicsText;
        
        const el_guidance_participants_transcript = document.getElementById('guidance-participants-transcript');
        if (el_guidance_participants_transcript) el_guidance_participants_transcript.textContent = participantsText;
    }
    document.addEventListener('DOMContentLoaded', updateGuidanceFields);

    function copyToClipboard(elementId, buttonElement) {
        const textToCopy = document.getElementById(elementId)?.innerText;
        if (textToCopy) {
            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    const originalText = buttonElement.innerText;
                    buttonElement.innerText = 'הועתק!';
                    setTimeout(() => {
                        buttonElement.innerText = originalText;
                    }, 2000);
                })
                .catch(err => {
                    console.error('Failed to copy text: ', err);
                    alert('ההעתקה נכשלה. אנא נסה/י להעתיק ידנית.');
                });
        }
    }

    </script>
</body>
</html>
